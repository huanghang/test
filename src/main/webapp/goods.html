<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Expires" CONTENT="0">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Cache-Control" CONTENT="no-store">
    <meta http-equiv="Pragma" content="no-cache">
    <title>商品信息--新增</title>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <link rel="stylesheet" type="text/css" href="css/soc.css">
    <script src="js/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script src="js/jquery.ajaxfileupload.js" type="text/javascript"></script>
    <script src="js/jquery.validate.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/jquery-form.min.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<div class="con_panel block">
    <div class="panel_body" >
        <div class="panel_body_title">
            <span>商品信息</span>
            <em>></em>
            <span>新增</span>
        </div>
        <form id="uploadForm">
            <ul class="panel_con w50">
                <div id="fade" class="fade">
                    <span id="error"></span>
                </div>
                <li class="w100">
                    <div>
                        <span>名称</span>
                        <em>*</em>
                    </div>
                    <input type="text" id="name" name="name" maxlength="20"/>
                </li>
                <li class="w100">
                    <div>
                        <span>大小</span>
                        <em>*</em>
                    </div>
                    <input type="text" id="size" name="size" maxlength="20"/>
                </li>
                <li class="w100">
                    <div>
                        <span>图片</span>
                        <em>*</em>
                    </div>
                    <input type="file" name="file" id="file" style="width: 190px;"/>
                    <input type="button" id="upload" value="上传" class="btn btn_b"/><br/>
                    <img  width="100px" height="100px" id="pic" style="margin-left:100px;"/>
                    <input type="hidden" name="image" id="image"/>
                </li>
                <li class="nbm w100">
                    <div></div>
                    <div class="op">
                        <input id="save" type="button" value="保存" class="btn btn_b"/>
                        <input type="button" id="back" value="返回" class="btn btn_o"/>
                    </div>
                </li>
            </ul>
        </form>
    </div>
</div>
</body>
</html>
<script type="text/javascript">
    $(function () {
        $("#pic").hide();
        $("#upload").click(function () {
            var formData = new FormData();
            formData.append('file', $('#file')[0].files[0]);
            $.ajax({
                url: 'goods/upload',
                type: 'POST',
                cache: false,
                data: formData,
                cache: false,
                processData: false,
                contentType: false,
                encType: "multipart/form-data",
                success: function (data) {
                    $("#image").val(data.message);
                    $("#pic").attr("src", data.message);
                    $("#pic").show();
                }, error: function (data) {
                    $("#error").val(data.message)
                }
            })
        });
        $("#save").click(function () {
            $.ajax({
                type: "POST",
                url: "goods/save",
                data: {
                    "name": $("#name").val(),
                    "size": $("#size").val(),
                    "image": $("#image").val()
                },
                success: function (data) {
                   alert("保存成功");
                }
            });
        });


    })

</script>